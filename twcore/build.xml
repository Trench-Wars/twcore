<?xml version="1.0" encoding="UTF-8"?>

<project name="twcore" default="all" basedir=".">
        
    <target name="all" depends="clean,core,bots" description="Builds the entire TWCore distribution">    	
    </target>
	
	<property name="mail.jar" value="lib/mail.jar"/>
	<property name="activation.jar" value="lib/activation.jar"/>
	<property name="gson.jar" value="lib/gson.jar"/>
	<property name="facebook4j" value="lib/facebook4j-core-1.1.3.jar"/>
	<property name="twitter4j" value="lib/twitter4j-core-3.0.3.jar"/>
	<path id="build.path">
		<pathelement location="${mail.jar}"/>
		<pathelement location="${activation.jar}"/>
		<pathelement location="${gson.jar}"/>
		<pathelement location="${facebook4j}"/>
		<pathelement location="${twitter4j}"/>
	</path>
	
    <target name="core" description="Builds the TWCore core" depends="configCopy">
    	<echo>Creating Temporary Directory</echo>
    	<mkdir dir="temp"></mkdir>
    	<echo>Compiling Core (this may take a moment)</echo>
    	<javac classpathref="build.path" srcdir="src/twcore/core" destdir="temp"/>    	    
    	<javac classpathref="build.path" srcdir="src/twcore/bots" destdir="temp" debug="on" debuglevel="lines,vars,source">
    		<include name="**.java" />
    	</javac>
    	<echo>Creating Jar File</echo>
    	<jar destfile="bin/twcore.jar">
    		<fileset dir="temp"></fileset>
    	</jar>
    	<echo>Deleting Temporary Directory</echo>
    	<delete dir="temp"/>
    </target>    
      
    <target name="bots" description="Builds the TWCore bots" depends="configCopy">
    	<echo>Compiling Bots (this may take a moment)</echo>
    	<javac classpath="bin/twcore.jar;lib/gson.jar;lib/facebook4j-core-1.1.3.jar;lib/twitter4j-core-3.0.3.jar" srcdir="src/twcore/bots" destdir="bin" debug="on" debuglevel="lines,vars,source" /> 
    </target> 

    <target name="clean" description="Deletes the jar and all class files">
    	<echo>Deleting Files</echo>
  		<delete failonerror="false">  			
  			<fileset dir="bin">
  				<include name="twcore.jar"/>
  			</fileset>
    		<fileset dir="bin/twcore">
		        <include name="**/**.class"/>
		    </fileset>
    	</delete>
    </target>
	
	<target name="botdir" description="Builds a specific directory under twcore/bots. Specify the directory name on the environment variable 'botdir' (with -D on command line)" depends="configCopy">
		<echo>Compiling bot directory ${botdir}</echo>
		<javac classpath="bin/twcore.jar;lib/gson.jar;lib/twitter4j-core-3.0.3.jar;lib/facebook4j-core-1.1.3.jar" srcdir="src/twcore/bots/${botdir}" destdir="bin" debug="on" debuglevel="lines,vars,source" />
	</target>
	
	<target name="configCopy" description="Copies all the .cfg files from the src directory to the bin directory if file doesn't exist">
		<echo>Copying Bot configuration files</echo>
    	<copy todir="bin" overwrite="no">
    		<fileset dir="src">
		        <include name="**/**.cfg"/>
				<include name="**/**.xml"/>
		    </fileset>
    	</copy>
	</target>	
	
	<target name="javadoc" description="Creates Java API Documentation">
		<javadoc 
			access="package" 
			author="true" 
			classpath="lib/mysql-connector-java-5.0.7-bin.jar;lib/googleapi.jar;lib/aim.jar;lib/mail.jar;lib/activation.jar;lib/gson.jar;lib/facebook4j-core-1.1.3.jar;lib/twitter4j-core-3.0.3.jar" 
			destdir="javadoc" 
			doctitle="Trench Wars Bot Core (TWCore) API Documentation" 
			nodeprecated="false" 
			nodeprecatedlist="false" 
			noindex="false" 
			nonavbar="false" 
			notree="false" 
			source="1.5" 
			sourcepath="src" 
			splitindex="true" 
			use="true" 
			version="true"/>
	</target>
    
</project>
